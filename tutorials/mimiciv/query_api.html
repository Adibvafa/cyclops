





<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MIMIC-IV query API tutorial &mdash; cyclops  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/cyclops.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Reference" href="../../api.html" />
    <link rel="prev" title="Tutorials" href="../../tutorials.html" />
<script type="text/javascript">
  window.onload = function() {
    document.body.innerHTML = document.body.innerHTML.replace(/ module/g, '');
    document.body.innerHTML = document.body.innerHTML.replace(/ package/g, '');
  }
</script>

</head>

<body class="wy-body-for-nav">
  <!--
    Lie about what theme we really are when some RTD-injected JS fetches the
    full versions panel from the RTD API.  RTD's JS replaces the stub versions
    panel in the Sphinx-generated HTML with the full versions panel it fetches
    from the RTD API.  If the API thinks we're not sphinx_rtd_theme, it will
    serve us the wrong HTML and the panel will float as a "badge" when it
    shouldn't.  As a customized version of sphinx_rtd_theme, we really do want
    the same HTML it gets.  See also the diagnoses in
    <https://github.com/nextstrain/docs.nextstrain.org/issues/76>.

    This bit of JS finds the data RTD injects into the page and modifies it
    before the code that RTD injects runs and looks at the data.  RTD's
    <script>s (in <head>) run before this JS, but they wait until the DOM is
    ready to actually do any work.  This gives us a chance to modify the data
    during DOM load before the RTD code actually uses it.

      -trs, 27 Jan 2022
  -->
  <script>
    (() => {
      try {
        console.log("Lying about the theme to RTD's JS so the versions panel works properly. üôà");

        /* Update global variable, which is used in the request to get the RTD
         * "footer" that includes the versions panel.
         */
        if (window.READTHEDOCS_DATA)
          window.READTHEDOCS_DATA.theme = "sphinx_rtd_theme";

        /* Update stored JSON in case anything else deserializes it later.
         * Comments in the RTD-injected HTML source claim the global variable
         * above is deprecated.
         */
        var script = document.querySelector("#READTHEDOCS_DATA");
        if (script)
          script.innerHTML = JSON.stringify({ ...JSON.parse(script.innerHTML), theme: "sphinx_rtd_theme" });
      }
      catch (err) {
        console.log("Lying about the theme to RTD's JS failed‚Ä¶ oh well. ü§∑", err);
      }
    })();
  </script>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #efeeed" >




  <a href="https://vectorinstitute.github.io/cyclops/">
    <img src="../../_static/cyclops_logo-dark.png" class="logo" alt="Logo"/>
  </a>



  <div class="subproject">
    <a href="../../index.html" class="project-name" alt="Documentation Home">
      cyclops
    </a>

    
    
    

  </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">üê£ Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#developing">üßëüèø‚Äçüíª Developing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#documentation">üìö Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#notebooks">üìì Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#citation">üéì Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to cyclops</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MIMIC-IV query API tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Imports-and-instantiate-MIMICIVQuerier">Imports and instantiate <code class="docutils literal notranslate"><span class="pre">MIMICIVQuerier</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-1.-Get-all-patient-encounters-from-2015-(approximate-year-of-care).">Example 1. Get all patient encounters from 2015 (approximate year of care).</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-2.-Get-all-patient-encounters-with-diagnoses-(schizophrenia-in-ICD-long-title),-in-the-year-2015.">Example 2. Get all patient encounters with diagnoses (<code class="docutils literal notranslate"><span class="pre">schizophrenia</span></code> in ICD long title), in the year 2015.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-3.-Advanced---uses-regexp_match-from-sqlalchemy.-Get-all-patient-encounters-with-diagnoses-(ICD-long-title-contains-schizophrenia-and-chronic-),-in-the-year-2015.">Example 3. Advanced - uses regexp_match from sqlalchemy. Get all patient encounters with diagnoses (ICD long title contains <code class="docutils literal notranslate"><span class="pre">schizophrenia</span></code> and <code class="docutils literal notranslate"><span class="pre">chronic</span></code> ), in the year 2015.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-4.-Advanced---uses-cyclops.query.utils.starts_with-helper-function.-Get-all-patient-encounters-with-diagnoses-(starts-with-Paranoid-in-ICD-long-title),-in-the-year-2015.">Example 4. Advanced - uses cyclops.query.utils.starts_with helper function. Get all patient encounters with diagnoses (starts with <code class="docutils literal notranslate"><span class="pre">Paranoid</span></code> in ICD long title), in the year 2015.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-5.-Get-all-patient-encounters-with-diagnoses-(ICD-code-is-F209).">Example 5. Get all patient encounters with diagnoses (ICD code is F209).</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-6.-Get-all-patient-encounters-with-diagnoses-(delirium-in-ICD-long-title).">Example 6. Get all patient encounters with diagnoses (<code class="docutils literal notranslate"><span class="pre">delirium</span></code> in ICD long title).</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-7.-Get-routine-vital-signs-for-patients-from-year-2015,-limit-to-100-rows.">Example 7. Get routine vital signs for patients from year 2015, limit to 100 rows.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-8.-Get-hemoglobin-lab-tests-for-patients-from-year-2009,-limit-to-100-rows.">Example 8. Get hemoglobin lab tests for patients from year 2009, limit to 100 rows.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-9.-Get-all-lab-events-for-patients-from-year-2010,-that-match-substring-‚Äúsodium‚Äù,-limit-to-100-rows.">Example 9. Get all lab events for patients from year 2010, that match substring ‚Äúsodium‚Äù, limit to 100 rows.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-10.-Get-respiratory-events-for-patients-from-year-2009,-limit-to-100-rows.">Example 10. Get respiratory events for patients from year 2009, limit to 100 rows.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-11.-Get-heart-rate-measurements-of-patients-with-delirium-diagnoses,-limit-to-1000-rows.">Example 11. Get heart rate measurements of patients with delirium diagnoses, limit to 1000 rows.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-12.-Get-d_items-dimension-table,-for-quick-reference.">Example 12. Get d_items dimension table, for quick reference.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-13.-Running-a-raw-SQL-string.">Example 13. Running a raw SQL string.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #efeeed" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">cyclops</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  

  
  
    <li><a href="https://vectorinstitute.github.io/cyclops/">Home</a></li>
    <li><a href="../../index.html">cyclops</a></li>
  

  
  
    <li><a href="../../tutorials.html">Tutorials</a></li>
  

  

      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/mimiciv/query_api.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="MIMIC-IV-query-API-tutorial">
<h1>MIMIC-IV query API tutorial<a class="headerlink" href="#MIMIC-IV-query-API-tutorial" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>This notebook shows examples of how to use the cyclops.query API on MIMIC-IV.</p>
<ul class="simple">
<li><p>First, setup the MIMIC-IV database according to the instructions in <a class="reference external" href="https://github.com/MIT-LCP/mimic-code/tree/main/mimic-iv/buildmimic/postgres">mimic-code</a>.</p></li>
<li><p>The database is assumed to be hosted using postgres. Update the config parameters such as username and password, passed to <code class="docutils literal notranslate"><span class="pre">MIMICIVQuerier</span></code> accordingly.</p></li>
</ul>
<section id="Imports-and-instantiate-MIMICIVQuerier">
<h2>Imports and instantiate <code class="docutils literal notranslate"><span class="pre">MIMICIVQuerier</span></code><a class="headerlink" href="#Imports-and-instantiate-MIMICIVQuerier" title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">select</span>

<span class="kn">import</span> <span class="nn">cyclops.query.util</span> <span class="k">as</span> <span class="nn">query_util</span>
<span class="kn">from</span> <span class="nn">cyclops.query.mimiciv</span> <span class="kn">import</span> <span class="n">MIMICIVQuerier</span>

<span class="n">mimic</span> <span class="o">=</span> <span class="n">MIMICIVQuerier</span><span class="p">(</span>
    <span class="n">dbms</span><span class="o">=</span><span class="s2">&quot;postgresql&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;mimiciv-2.0&quot;</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;pwd&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:23,775 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Database setup, ready to run queries!
</pre></div></div>
</div>
</section>
<section id="Example-1.-Get-all-patient-encounters-from-2015-(approximate-year-of-care).">
<h2>Example 1. Get all patient encounters from 2015 (approximate year of care).<a class="headerlink" href="#Example-1.-Get-all-patient-encounters-from-2015-(approximate-year-of-care)." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">2015</span><span class="p">)</span>
<span class="n">encounters</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encounters</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:25,133 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:25,135 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 1.330279 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
69460 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-2.-Get-all-patient-encounters-with-diagnoses-(schizophrenia-in-ICD-long-title),-in-the-year-2015.">
<h2>Example 2. Get all patient encounters with diagnoses (<code class="docutils literal notranslate"><span class="pre">schizophrenia</span></code> in ICD long title), in the year 2015.<a class="headerlink" href="#Example-2.-Get-all-patient-encounters-with-diagnoses-(schizophrenia-in-ICD-long-title),-in-the-year-2015." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2015</span><span class="p">])</span>
<span class="n">encounters_schizophrenia</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span>
    <span class="n">diagnosis_substring</span><span class="o">=</span><span class="s2">&quot;schizophrenia&quot;</span><span class="p">,</span> <span class="n">patients</span><span class="o">=</span><span class="n">encounters</span>
<span class="p">)</span>
<span class="n">encounters_schizophrenia</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encounters_schizophrenia</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
<span class="n">encounters_schizophrenia</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;diagnosis_title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:25,928 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:25,929 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 0.760619 s
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4731 rows extracted!
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unspecified schizophrenia, unspecified                                     1511
Schizophrenia, unspecified                                                 1431
Paranoid type schizophrenia, unspecified                                    527
Paranoid schizophrenia                                                      381
Paranoid type schizophrenia, chronic                                        279
Paranoid type schizophrenia, chronic with acute exacerbation                174
Unspecified schizophrenia, chronic                                           77
Catatonic schizophrenia                                                      68
Other specified types of schizophrenia, unspecified                          43
Catatonic type schizophrenia, unspecified                                    37
Other schizophrenia                                                          33
Disorganized type schizophrenia, chronic with acute exacerbation             20
Catatonic type schizophrenia, chronic with acute exacerbation                19
Disorganized type schizophrenia, unspecified                                 19
Unspecified schizophrenia, chronic with acute exacerbation                   18
Other specified types of schizophrenia, chronic with acute exacerbation      15
Personal history of schizophrenia                                            13
Paranoid type schizophrenia, subchronic with acute exacerbation              12
Disorganized schizophrenia                                                   11
Disorganized type schizophrenia, chronic                                      9
Catatonic type schizophrenia, chronic                                         7
Residual schizophrenia                                                        6
Catatonic type schizophrenia, subchronic with acute exacerbation              4
Other specified types of schizophrenia, chronic                               3
Paranoid type schizophrenia, subchronic                                       3
Simple type schizophrenia, unspecified                                        2
Disorganized type schizophrenia, subchronic with acute exacerbation           2
Simple type schizophrenia, chronic                                            2
Unspecified schizophrenia, in remission                                       2
Latent schizophrenia, unspecified                                             2
Undifferentiated schizophrenia                                                1
Name: diagnosis_title, dtype: int64
</pre></div></div>
</div>
</section>
<section id="Example-3.-Advanced---uses-regexp_match-from-sqlalchemy.-Get-all-patient-encounters-with-diagnoses-(ICD-long-title-contains-schizophrenia-and-chronic-),-in-the-year-2015.">
<h2>Example 3. Advanced - uses regexp_match from sqlalchemy. Get all patient encounters with diagnoses (ICD long title contains <code class="docutils literal notranslate"><span class="pre">schizophrenia</span></code> and <code class="docutils literal notranslate"><span class="pre">chronic</span></code> ), in the year 2015.<a class="headerlink" href="#Example-3.-Advanced---uses-regexp_match-from-sqlalchemy.-Get-all-patient-encounters-with-diagnoses-(ICD-long-title-contains-schizophrenia-and-chronic-),-in-the-year-2015." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2015</span><span class="p">])</span>
<span class="n">diagnoses</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span><span class="n">patients</span><span class="o">=</span><span class="n">encounters</span><span class="p">)</span>
<span class="n">subquery</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">select</span><span class="p">(</span><span class="n">diagnoses</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
    <span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">diagnoses</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">diagnosis_title</span><span class="o">.</span><span class="n">regexp_match</span><span class="p">(</span>
            <span class="s2">&quot;(?=.*schizophrenia)(?=.*chronic)&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">subquery</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">patients_schizophrenia_chronic</span> <span class="o">=</span> <span class="n">diagnoses</span>
<span class="n">patients_schizophrenia_chronic</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">subquery</span>
<span class="n">patients_schizophrenia_chronic</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_schizophrenia_chronic</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:27,576 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:27,577 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 1.606089 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
644 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-4.-Advanced---uses-cyclops.query.utils.starts_with-helper-function.-Get-all-patient-encounters-with-diagnoses-(starts-with-Paranoid-in-ICD-long-title),-in-the-year-2015.">
<h2>Example 4. Advanced - uses cyclops.query.utils.starts_with helper function. Get all patient encounters with diagnoses (starts with <code class="docutils literal notranslate"><span class="pre">Paranoid</span></code> in ICD long title), in the year 2015.<a class="headerlink" href="#Example-4.-Advanced---uses-cyclops.query.utils.starts_with-helper-function.-Get-all-patient-encounters-with-diagnoses-(starts-with-Paranoid-in-ICD-long-title),-in-the-year-2015." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2015</span><span class="p">])</span>
<span class="n">diagnoses</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span><span class="n">patients</span><span class="o">=</span><span class="n">encounters</span><span class="p">)</span>
<span class="n">subquery</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">select</span><span class="p">(</span><span class="n">diagnoses</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">query_util</span><span class="o">.</span><span class="n">starts_with</span><span class="p">(</span><span class="n">diagnoses</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">diagnosis_title</span><span class="p">,</span> <span class="s2">&quot;Paranoid&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">subquery</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">patients_schizophrenia</span> <span class="o">=</span> <span class="n">diagnoses</span>
<span class="n">patients_schizophrenia</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">subquery</span>
<span class="n">patients_schizophrenia</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_schizophrenia</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:36,607 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:36,608 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 8.971026 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1429 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-5.-Get-all-patient-encounters-with-diagnoses-(ICD-code-is-F209).">
<h2>Example 5. Get all patient encounters with diagnoses (ICD code is F209).<a class="headerlink" href="#Example-5.-Get-all-patient-encounters-with-diagnoses-(ICD-code-is-F209)." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patients</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patients</span><span class="p">()</span>
<span class="n">patients_f209</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span><span class="n">diagnosis_codes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;F209&quot;</span><span class="p">],</span> <span class="n">patients</span><span class="o">=</span><span class="n">patients</span><span class="p">)</span>
<span class="n">patients_f209</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_f209</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:46,239 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:46,239 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 9.602344 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1431 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-6.-Get-all-patient-encounters-with-diagnoses-(delirium-in-ICD-long-title).">
<h2>Example 6. Get all patient encounters with diagnoses (<code class="docutils literal notranslate"><span class="pre">delirium</span></code> in ICD long title).<a class="headerlink" href="#Example-6.-Get-all-patient-encounters-with-diagnoses-(delirium-in-ICD-long-title)." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patients</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patients</span><span class="p">()</span>
<span class="n">patients_delirium</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span>
    <span class="n">diagnosis_substring</span><span class="o">=</span><span class="s2">&quot;delirium&quot;</span><span class="p">,</span> <span class="n">patients</span><span class="o">=</span><span class="n">patients</span>
<span class="p">)</span>
<span class="n">patients_delirium</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_delirium</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:40:47,116 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:40:47,117 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 0.858650 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9000 rows extracted!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patients_delirium</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;diagnosis_title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Delirium due to conditions classified elsewhere                                  3938
Delirium due to known physiological condition                                    3075
Drug-induced delirium                                                             963
Alcohol withdrawal delirium                                                       373
Alcohol dependence with withdrawal delirium                                       210
Vascular dementia, with delirium                                                  169
Senile dementia with delirium                                                      88
Subacute delirium                                                                  35
Alcohol dependence with intoxication delirium                                      28
Alcohol abuse with intoxication delirium                                           20
Other psychoactive substance use, unspecified with intoxication with delirium      15
Sedative, hypnotic or anxiolytic dependence with withdrawal delirium               14
Opioid use, unspecified with intoxication delirium                                 10
Presenile dementia with delirium                                                    8
Other stimulant abuse with intoxication delirium                                    7
Other psychoactive substance abuse with intoxication delirium                       6
Opioid abuse with intoxication delirium                                             5
Cocaine abuse with intoxication with delirium                                       5
Other psychoactive substance use, unspecified with withdrawal delirium              4
Other stimulant dependence with intoxication delirium                               3
Hallucinogen abuse with intoxication with delirium                                  3
Cocaine dependence with intoxication delirium                                       3
Cannabis abuse with intoxication delirium                                           2
Sedative, hypnotic or anxiolytic use, unspecified with intoxication delirium        2
Sedative, hypnotic or anxiolytic dependence with intoxication delirium              2
Sedative, hypnotic or anxiolytic abuse with intoxication delirium                   2
Hallucinogen use, unspecified with intoxication with delirium                       2
Opioid dependence with intoxication delirium                                        2
Other psychoactive substance dependence with intoxication delirium                  2
Other stimulant use, unspecified with intoxication delirium                         1
Cannabis use, unspecified with intoxication delirium                                1
Other psychoactive substance dependence with withdrawal delirium                    1
Cocaine use, unspecified with intoxication delirium                                 1
Name: diagnosis_title, dtype: int64
</pre></div></div>
</div>
</section>
<section id="Example-7.-Get-routine-vital-signs-for-patients-from-year-2015,-limit-to-100-rows.">
<h2>Example 7. Get routine vital signs for patients from year 2015, limit to 100 rows.<a class="headerlink" href="#Example-7.-Get-routine-vital-signs-for-patients-from-year-2015,-limit-to-100-rows." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2018</span><span class="p">])</span>
<span class="n">patients_vitals</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">events</span><span class="p">(</span>
    <span class="n">patient_encounters_table</span><span class="o">=</span><span class="n">encounters</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="s2">&quot;Routine Vital Signs&quot;</span>
<span class="p">)</span>
<span class="n">patients_vitals</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_vitals</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:42:37,628 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:42:37,630 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 110.449480 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-8.-Get-hemoglobin-lab-tests-for-patients-from-year-2009,-limit-to-100-rows.">
<h2>Example 8. Get hemoglobin lab tests for patients from year 2009, limit to 100 rows.<a class="headerlink" href="#Example-8.-Get-hemoglobin-lab-tests-for-patients-from-year-2009,-limit-to-100-rows." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2009</span><span class="p">])</span>
<span class="n">patients_hemo_labs</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">events</span><span class="p">(</span>
    <span class="n">categories</span><span class="o">=</span><span class="s2">&quot;labs&quot;</span><span class="p">,</span>
    <span class="n">patient_encounters_table</span><span class="o">=</span><span class="n">encounters</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
    <span class="n">event_names</span><span class="o">=</span><span class="s2">&quot;hemoglobin&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">patients_hemo_labs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_hemo_labs</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:42:39,817 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:42:39,819 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 1.730873 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-9.-Get-all-lab-events-for-patients-from-year-2010,-that-match-substring-‚Äúsodium‚Äù,-limit-to-100-rows.">
<h2>Example 9. Get all lab events for patients from year 2010, that match substring ‚Äúsodium‚Äù, limit to 100 rows.<a class="headerlink" href="#Example-9.-Get-all-lab-events-for-patients-from-year-2010,-that-match-substring-‚Äúsodium‚Äù,-limit-to-100-rows." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2009</span><span class="p">])</span>
<span class="n">patients_sodium_labs</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">events</span><span class="p">(</span>
    <span class="n">categories</span><span class="o">=</span><span class="s2">&quot;labs&quot;</span><span class="p">,</span>
    <span class="n">patient_encounters_table</span><span class="o">=</span><span class="n">encounters</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
    <span class="n">event_name_substring</span><span class="o">=</span><span class="s2">&quot;sodium&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">patients_sodium_labs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_sodium_labs</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:42:41,187 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:42:41,188 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 1.321206 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-10.-Get-respiratory-events-for-patients-from-year-2009,-limit-to-100-rows.">
<h2>Example 10. Get respiratory events for patients from year 2009, limit to 100 rows.<a class="headerlink" href="#Example-10.-Get-respiratory-events-for-patients-from-year-2009,-limit-to-100-rows." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2009</span><span class="p">])</span>
<span class="n">patients_respiratory</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">events</span><span class="p">(</span>
    <span class="n">categories</span><span class="o">=</span><span class="s2">&quot;Respiratory&quot;</span><span class="p">,</span> <span class="n">patient_encounters_table</span><span class="o">=</span><span class="n">encounters</span><span class="o">.</span><span class="n">query</span>
<span class="p">)</span>
<span class="n">patients_respiratory</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_respiratory</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:44:01,944 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:44:01,946 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 80.729833 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-11.-Get-heart-rate-measurements-of-patients-with-delirium-diagnoses,-limit-to-1000-rows.">
<h2>Example 11. Get heart rate measurements of patients with delirium diagnoses, limit to 1000 rows.<a class="headerlink" href="#Example-11.-Get-heart-rate-measurements-of-patients-with-delirium-diagnoses,-limit-to-1000-rows." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patients</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patients</span><span class="p">()</span>
<span class="n">encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_encounters</span><span class="p">(</span><span class="n">patients_table</span><span class="o">=</span><span class="n">patients</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
<span class="n">delirium_encounters</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">patient_diagnoses</span><span class="p">(</span>
    <span class="n">diagnosis_substring</span><span class="o">=</span><span class="s2">&quot;delirium&quot;</span><span class="p">,</span> <span class="n">patients_table</span><span class="o">=</span><span class="n">encounters</span><span class="o">.</span><span class="n">query</span>
<span class="p">)</span>
<span class="n">patients_delirium_heart_rate</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">events</span><span class="p">(</span>
    <span class="n">event_names</span><span class="o">=</span><span class="s2">&quot;Heart Rate&quot;</span><span class="p">,</span> <span class="n">patient_encounters_table</span><span class="o">=</span><span class="n">delirium_encounters</span><span class="o">.</span><span class="n">query</span>
<span class="p">)</span>
<span class="n">patients_delirium_heart_rate</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">patients_delirium_heart_rate</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:45:19,801 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:45:19,802 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 77.812058 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1000 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-12.-Get-d_items-dimension-table,-for-quick-reference.">
<h2>Example 12. Get d_items dimension table, for quick reference.<a class="headerlink" href="#Example-12.-Get-d_items-dimension-table,-for-quick-reference." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_lookup_table</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="n">mimic</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s2">&quot;event_labels&quot;</span><span class="p">))</span>
<span class="n">lookup_data</span> <span class="o">=</span> <span class="n">event_lookup_table</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lookup_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:45:19,829 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:45:19,830 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 0.019274 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4014 rows extracted!
</pre></div></div>
</div>
</section>
<section id="Example-13.-Running-a-raw-SQL-string.">
<h2>Example 13. Running a raw SQL string.<a class="headerlink" href="#Example-13.-Running-a-raw-SQL-string." title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">mimic</span><span class="o">.</span><span class="n">_db</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM mimiciv_hosp.admissions LIMIT 100&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows extracted!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-10 11:45:19,842 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.query.orm - Query returned successfully!
2023-01-10 11:45:19,843 <span class="ansi-white-intense-fg ansi-bold">INFO</span> cyclops.utils.profile - Finished executing function run_query in 0.006526 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100 rows extracted!
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

  <div class="citation">
    CyclOps team <i>et al.,</i>
    <a href="https://www.medrxiv.org/content/10.1101/2022.12.02.22283021v2">CyclOps: Cyclical development towards Operationalizing ML models for health</a>
    <i>, medarxiv</i> (2022)
  </def>


  <p class="avatar">cyclops is built by</p>
  <div class="avatar">
    
    
    <span>
      <a href="https://github.com/amrit110">
        <img src="../../_static/team/amrit-krishnan.jpg" width="32"/>
        Amrit Krishnan
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/KadenMc">
        <img src="../../_static/team/kaden-mckeen.jpg" width="32"/>
        Kaden McKeen
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/vsubasri">
        <img src="../../_static/team/valli-subasri.jpg" width="32"/>
        Valli Subasri
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/a-kore">
        <img src="../../_static/team/ali-kore.jpg" width="32"/>
        Ali Kore
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/fcogidi">
        <img src="../../_static/team/franklin-ogidi.jpg" width="32"/>
        Franklin Ogidi
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/mahshidaln">
        <img src="../../_static/team/mahshid-alinoori.jpg" width="32"/>
        Mahshid Alinoori
      </a>
    </span>
    ,
    
    <span>
      <a href="https://github.com/elhamdolatabadi">
        <img src="../../_static/team/elham-dolatabadi.jpg" width="32"/>
        Elham Dolatabadi
      </a>
    </span>
    ,
  </div>


  <div class="footer-small-text">
    All <a href="https://github.com/VectorInstitute/cyclops">source code for cyclops</a> is freely available under the terms of an <a href="https://opensource.org/licenses/Apache-2.0">Apache-2.0</a> license.
  </div>

  <div class="footer-small-text">
    This work is made possible due to the data obtained from the
    General Medicine Inpatient Initiative (GEMINI).
  </div>

  <hr/>

  <div class="logo">
    <a class="logo" href="https://vectorinstitute.ai/">
      <span class="logo"></span>
      <img alt="Logo of the Vector Institute" style="width:90px; max-width:90px;" src="../../_static/logos/vector_logo.png" />
    </a>
    <a class="logo" href="https://www.geminimedicine.ca/">
      <span class="logo"></span>
      <img alt="Logo of GEMINI" style="width:90px; max-width:90px;" src="../../_static/logos/gemini_logo.png" />
    </a>
  </div>

  <div class="copyright">
    &copy; Copyright 2022, Vector AI Engineering
  </div>

  <div class="copyright">
    </p>
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using customised version of
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">base theme</a> provided by
    <a href="https://readthedocs.org">Read the Docs</a>.
  </div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>